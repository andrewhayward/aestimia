{% extends "layout.html" %}
{% block head %}
<style>
#js-console {
  height: 345px;
  padding: 4px;
  font-family: Menlo, Monaco, "Lucida Console", monospace;
  font-size: 10px;
  line-height: 12px;
  white-space: pre-wrap;
  color: gray;
  background: black;
  overflow: auto;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}

#js-console.affix {
  position: fixed;
  top: 20px;
  width: 460px;
}

#js-console .exec {
  color: white;
}
</style>
{% endblock %}
{% block title %} - API Demo{% endblock %}
{% block content %}
<h1>Aestimia API Demo Control Panel</h1>

<div class="row">
  <div class="span6">

<h2>API Secret</h2>

<p>All of the functionality on the page is just a front-end to the API. Enter your API secret below, or else nothing on this page will work.</p>

<p><input type="password" id="js-password"></p>
<p>
  <label class="checkbox">
    <input id="js-show-password" type="checkbox"> Show API secret in console
  </label>
</p>

<h2>API Operations</h2>

<div class="accordion" id="api-actions">
  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#api-actions" href="#overview">
        Overview
      </a>
    </div>
    <div id="overview" class="accordion-body collapse">
      <div class="accordion-inner">
        <p>The API is accessed from <code class="js-api-root"></code>.</p>
        <p>Unless otherwise noted, all data is sent and received as JSON.</p>
        <p>All timestamps are returned in ISO 8601 format:</p>
        <pre>YYYY-MM-DDTHH:MM:SSZ</pre>
        <p>Authentication is done using HTTP Basic Authentication, with the
          username <strong>api</strong> and the password set to the API
          secret.</p>
      </div>
    </div>
  </div>

  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#api-actions" href="#mentor-list">
        List mentors
      </a>
    </div>
    <div id="mentor-list" class="accordion-body collapse">
      <div class="accordion-inner">
        <pre>GET /mentors</pre>

        <p>This endpoint returns a list of all mentors. There are no
          parameters.</p>

        <button id="js-list-mentors" class="btn">List Mentors</button>        
      </div>
    </div>
  </div>

  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#api-actions" href="#mentor-update">
        Update a mentor
      </a>
    </div>
    <div id="mentor-update" class="accordion-body collapse">
      <div class="accordion-inner">
        <pre>POST /mentor</pre>

        <p>This endpoint is used to add, change, and remove mentors. If
          the <code>classifications</code> parameter is not supplied,
          the mentor is removed. Otherwise, the mentor is given access to
          view and assess any submissions that have at least one of
          the mentor's classifications.</p>

        <p>Below is an example body, which you can modify and use 
          yourself.</p>

        <textarea class="input-block-level" rows="4" style="font-family: monospace" id="js-update-mentor-json">{
  "email": "foo@bar.org",
  "classifications": ["math"]
}</textarea>

        <button class="btn btn-primary" id="js-update-mentor">Update Mentor</button>
      </div>
    </div>
  </div>

  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#api-actions" href="#submission-create">
        Create a submission
      </a>
    </div>
    <div id="submission-create" class="accordion-body collapse">
      <div class="accordion-inner">
        <pre>POST /submit</pre>

        <p>This endpoint creates a submission for assessment.</p>

        <p>Below are some common submissions, which you can choose, modify,
          and use as the body of a request.</p>

        <ul class="nav nav-tabs" id="submissions">
          {% for submission in submissions %}
          <li><a data-toggle="tab" href="#submission-{{ submission.name }}">{{ submission.name }}</a></li>
          {% endfor %}
        </ul>

        <div class="tab-content">
          {% for submission in submissions %}
          <div class="tab-pane" id="submission-{{ submission.name }}">
            <form class="js-submission">
              <textarea autocomplete="off" style="font-family: monospace" rows="30" class="input-block-level" name="json">{{ submission.json }}</textarea>
              <input class="btn btn-primary" type="submit" value="Create Submission">
            </form>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>

  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#api-actions" href="#submission-list">
        List submissions
      </a>
    </div>
    <div id="submission-list" class="accordion-body collapse">
      <div class="accordion-inner">
        <pre>GET /submissions</pre>

        <p>This endpoint returns a list of all submissions that satisfy
          a search criteria. Each criteria is submitted as a query
          string argument.</p>

        <p>Currently, the only search criteria is
          <code>learner</code>, which is the email of a learner
          whose submissions you'd like to retrieve.</p>

        <p>Use the form below to try out this endpoint.</p>

        <form>
          <label>Learner</label>
          <input type="text" id="js-learner" placeholder="user@domain.com" value="brian@example.org">
        </form>

        <button id="js-list-submissions" class="btn">List Submissions</button>
      </div>
    </div>
  </div>
</div>
</div>
<div class="span6">
  <h2>Console</h2>
  <p>This console shows you what API calls your actions on the left
    column are making.</p>
  <div id="js-console" data-spy="affix" data-offset-top="200"></div>
</div>
</div>
{% endblock %}
{% block scripts %}
<script src="/js/demo.js"></script>
{% endblock %}
